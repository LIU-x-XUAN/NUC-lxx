<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>疫苗接种信息与不良反应记录</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.staticfile.org/layui/2.6.3/css/layui.css">
    <style>
        .container {padding: 20px;}
        .form-item {margin-bottom: 15px;}
        .form-label {display: inline-block; width: 140px; text-align: right; margin-right: 10px; vertical-align: middle;}
        .form-content {display: inline-block; vertical-align: middle;}
        .required {color: red; margin-right: 5px;}
        .section-box {margin: 20px 0; padding: 15px; border: 1px solid #eee; border-radius: 4px; background-color: #fafafa;}
        .section-title {font-size: 16px; font-weight: bold; margin-bottom: 15px; color: #1E9FFF; padding-bottom: 10px; border-bottom: 1px solid #eee;}
        .tip-text {color: #666; font-size: 13px; margin: 5px 0 15px 150px;}
        .btn-group {margin: 30px 0; text-align: center;}
        .reaction-area {display: none; margin-top: 15px; padding-top: 15px; border-top: 1px dashed #eee;}
    </style>
</head>
<body>
<div class="container">
    <fieldset class="layui-elem-field">
        <legend>疫苗接种信息与不良反应记录</legend>
        <div class="layui-field-box">
            <!-- 居民选择 -->
            <div class="form-item">
                <label class="form-label"><span class="required">*</span>居民选择</label>
                <div class="form-content">
                    <select class="layui-select" id="residentSelect" style="width: 300px;">
                        <option value="">请选择居民</option>
                        <option value="1">张三 - 男 - 35岁 - 健康</option>
                        <option value="2">李四 - 女 - 28岁 - 过敏体质</option>
                        <option value="3">王五 - 男 - 65岁 - 高血压</option>
                        <option value="4">赵六 - 女 - 5岁 - 健康</option>
                    </select>
                </div>
            </div>

            <!-- 疫苗信息区 -->
            <div class="section-box">
                <div class="section-title"><i class="layui-icon layui-icon-medkit"></i> 疫苗信息区</div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>疫苗名称</label>
                    <div class="form-content">
                        <select class="layui-select" id="vaccineName" style="width: 300px;">
                            <option value="">请选择疫苗</option>
                            <option value="influenza">流感疫苗</option>
                            <option value="pneumonia">肺炎球菌疫苗</option>
                            <option value="hpv">HPV疫苗</option>
                            <option value="hepatitisB">乙型肝炎疫苗</option>
                            <option value="measles">麻疹疫苗</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>生产厂家</label>
                    <div class="form-content">
                        <input type="text" class="layui-input" id="manufacturer" style="width: 300px;" placeholder="输入疫苗生产厂家">
                    </div>
                </div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>疫苗批号</label>
                    <div class="form-content">
                        <input type="text" class="layui-input" id="batchNumber" style="width: 300px;" placeholder="输入疫苗批号">
                    </div>
                </div>
                <div class="tip-text">提示：疫苗批号可从疫苗追溯平台获取</div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>有效期至</label>
                    <div class="form-content">
                        <input type="text" class="layui-input" id="expiryDate" style="width: 300px;" placeholder="选择疫苗有效期">
                    </div>
                </div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>接种部位</label>
                    <div class="form-content">
                        <select class="layui-select" id="inoculationSite" style="width: 300px;">
                            <option value="">请选择接种部位</option>
                            <option value="upperArm">上臂三角肌</option>
                            <option value="thigh">大腿前外侧</option>
                            <option value="other">其他部位</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>接种剂量</label>
                    <div class="form-content">
                        <input type="text" class="layui-input" id="dosage" style="width: 300px;" placeholder="输入接种剂量，如：0.5ml">
                    </div>
                </div>
                
                <div class="form-item">
                    <label class="form-label"><span class="required">*</span>接种医护人员</label>
                    <div class="form-content">
                        <input type="text" class="layui-input" id="doctorName" style="width: 300px;" placeholder="输入接种医护人员姓名">
                    </div>
                </div>
            </div>

            <!-- 不良反应区 -->
            <div class="section-box">
                <div class="section-title"><i class="layui-icon layui-icon-notice"></i> 不良反应区</div>
                
                <div class="form-item">
                    <label class="form-label">是否有不良反应</label>
                    <div class="form-content">
                        <input type="checkbox" name="hasReaction" id="hasReaction" lay-skin="primary" title="是">
                    </div>
                </div>
                
                <div class="reaction-area" id="reactionDetails">
                    <div class="form-item">
                        <label class="form-label"><span class="required">*</span>症状描述</label>
                        <div class="form-content">
                            <textarea class="layui-textarea" id="symptoms" style="width: 500px; height: 100px;" placeholder="请描述不良反应症状"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label"><span class="required">*</span>出现时间</label>
                        <div class="form-content">
                            <input type="text" class="layui-input" id="reactionTime" style="width: 300px;" placeholder="选择不良反应出现时间">
                        </div>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label"><span class="required">*</span>反应程度</label>
                        <div class="form-content">
                            <select class="layui-select" id="reactionLevel" style="width: 300px;">
                                <option value="">请选择反应程度</option>
                                <option value="mild">轻度</option>
                                <option value="moderate">中度</option>
                                <option value="severe">重度</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label"><span class="required">*</span>处理措施</label>
                        <div class="form-content">
                            <textarea class="layui-textarea" id="treatment" style="width: 500px; height: 100px;" placeholder="请描述采取的处理措施"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label">恢复时间</label>
                        <div class="form-content">
                            <input type="text" class="layui-input" id="recoveryTime" style="width: 300px;" placeholder="选择恢复时间（如已恢复）">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 提交记录按钮 -->
            <div class="btn-group">
                <button class="layui-btn" id="submitRecordBtn"><i class="layui-icon layui-icon-submit"></i> 提交记录</button>
            </div>
        </div>
    </fieldset>
</div>

<script src="https://cdn.staticfile.org/layui/2.6.3/layui.js"></script>
<script>
    // 不使用jQuery，采用原生JavaScript实现
    layui.use(['form', 'laydate', 'layer'], function() {
        var form = layui.form;
        var laydate = layui.laydate;
        var layer = layui.layer;
        
        // 辅助函数：通过ID获取元素
        function $(id) {
            return document.getElementById(id);
        }
        
        // 初始化日期选择器
        laydate.render({
            elem: 'expiryDate',
            type: 'date'
        });
        
        // 不良反应出现时间选择器
        laydate.render({
            elem: 'reactionTime',
            type: 'datetime'
        });
        
        // 恢复时间选择器
        laydate.render({
            elem: 'recoveryTime',
            type: 'datetime'
        });
        
        // 不良反应复选框事件
        $('hasReaction').addEventListener('change', function() {
            var reactionDetails = $('reactionDetails');
            if (this.checked) {
                reactionDetails.style.display = 'block';
            } else {
                reactionDetails.style.display = 'none';
            }
        });
        
        // 提交记录按钮点击事件
        $('submitRecordBtn').addEventListener('click', function() {
            // 基本信息验证
            var residentId = $('residentSelect').value;
            var vaccineName = $('vaccineName').value;
            var manufacturer = $('manufacturer').value;
            var batchNumber = $('batchNumber').value;
            
            if (!residentId || !vaccineName || !manufacturer || !batchNumber) {
                layer.msg('请填写完整的疫苗信息和选择居民', {icon: 2});
                return;
            }
            
            // 检查不良反应信息（如果勾选）
            if ($('hasReaction').checked) {
                var symptoms = $('symptoms').value;
                var reactionTime = $('reactionTime').value;
                var reactionLevel = $('reactionLevel').value;
                var treatment = $('treatment').value;
                
                if (!symptoms || !reactionTime || !reactionLevel || !treatment) {
                    layer.msg('请填写完整的不良反应信息', {icon: 2});
                    return;
                }
            }
            
            // 模拟提交
            layer.confirm('确定要提交疫苗接种及不良反应记录吗？', function(index) {
                layer.close(index);
                layer.msg('正在提交记录...', {icon: 16, time: 1500}, function() {
                    layer.msg('记录提交成功', {icon: 1});
                    // 实际应用中可在此处重置表单或跳转页面
                });
            });
        });
        
        // 初始化表单渲染
        form.render();
    });
</script>
</body>
</html>
